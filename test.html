<!doctype html>
<html>
  <body>
    <script type="module">
      const gpu = navigator.gpu;
      if (!gpu) document.body.textContent = 'WebGPU not supported on this browser';

      const adapter = await gpu.requestAdapter();
      if (!adapter) document.body.textContent = 'No appropriate GPU adapter found';

      const device = await adapter.requestDevice();

      const format = gpu.getPreferredCanvasFormat();

      // prettier-ignore
      const tests = [
        { code: 'sample_bool(uv, true)', lines: 1, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,6,8,2,0,0,0,229,173,35,27,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,0,110,73,68,65,84,72,75,237,150,49,14,192,48,8,3,241,255,31,237,14,180,40,9,165,234,108,57,19,2,101,224,176,12,8,63,19,24,8,128,228,90,2,182,12,128,136,32,153,65,197,253,151,9,235,17,216,70,190,142,255,144,66,23,71,101,244,160,184,163,36,240,46,142,162,243,199,57,172,18,85,49,141,206,209,87,201,228,37,170,104,220,215,215,90,201,195,162,204,227,182,154,231,10,57,46,21,163,212,35,112,1,97,189,81,7,37,3,150,148,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_bool(uv, false)', lines: 1, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,6,8,2,0,0,0,229,173,35,27,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,0,124,73,68,65,84,72,75,237,150,81,14,192,32,8,67,219,251,31,154,101,33,97,12,113,49,251,35,41,95,138,104,244,41,69,66,38,2,27,2,52,179,60,68,18,64,56,163,235,141,108,121,34,217,175,35,236,163,9,220,151,90,46,62,123,188,253,29,227,231,95,99,70,115,209,230,1,188,50,190,200,134,3,106,31,71,171,46,1,116,149,25,177,158,72,224,167,114,148,250,178,123,64,19,137,104,207,79,146,31,150,149,162,10,229,195,145,133,36,244,70,148,167,19,184,0,177,141,84,7,165,254,139,41,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_u32(uv, 0)', lines: 1, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,6,8,2,0,0,0,229,173,35,27,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,0,75,73,68,65,84,72,75,237,150,65,10,0,48,8,195,236,255,31,221,49,58,156,23,127,144,30,4,241,22,130,170,34,16,88,8,168,170,108,103,42,221,150,64,224,249,16,51,162,133,109,252,192,140,38,160,8,49,43,116,32,240,55,71,175,13,46,11,90,76,2,252,28,248,176,18,56,178,126,27,7,62,246,204,28,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_u32(uv, 4294967295)', lines: 1, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,6,8,2,0,0,0,229,173,35,27,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,0,165,73,68,65,84,72,75,237,86,65,14,128,48,8,147,255,63,122,102,193,212,10,174,198,37,219,9,79,72,2,204,182,150,217,81,79,33,48,64,192,60,223,90,51,187,98,127,245,60,146,57,51,81,133,38,220,252,115,214,107,85,17,186,1,129,46,8,71,159,117,16,98,150,14,226,95,85,249,75,188,79,238,172,51,27,16,169,17,64,224,162,39,56,71,182,19,254,125,65,234,200,111,92,106,161,132,65,207,227,130,38,238,243,201,62,69,228,82,4,30,20,194,63,130,43,100,94,181,213,143,92,65,172,48,94,106,24,167,53,180,20,151,106,222,197,160,77,34,200,133,183,207,196,157,67,148,136,91,136,112,160,162,112,41,2,39,206,101,174,7,75,18,44,150,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_i32(uv, 0)', lines: 1, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,6,8,2,0,0,0,229,173,35,27,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,0,75,73,68,65,84,72,75,237,150,65,10,0,48,8,195,236,255,31,221,49,58,156,23,127,144,30,4,241,22,130,170,34,16,88,8,168,170,108,103,42,221,150,64,224,249,16,51,162,133,109,252,192,140,38,160,8,49,43,116,32,240,55,71,175,13,46,11,90,76,2,252,28,248,176,18,56,178,126,27,7,62,246,204,28,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_i32(uv, 2147483647)', lines: 1, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,6,8,2,0,0,0,229,173,35,27,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,0,158,73,68,65,84,72,75,237,86,91,14,128,48,8,131,251,31,26,179,144,32,129,61,80,131,95,221,151,67,233,102,75,10,76,88,96,96,193,0,19,145,136,232,91,230,177,213,37,34,126,27,34,150,18,18,67,86,70,174,68,138,103,65,211,110,6,216,203,105,207,42,97,168,149,16,201,101,20,178,50,242,62,226,1,143,103,117,243,2,252,33,193,202,42,234,66,106,13,233,247,71,231,8,182,228,29,104,131,179,50,51,72,216,202,192,221,86,62,54,145,220,104,158,58,135,149,151,255,97,187,85,110,115,173,188,0,124,56,199,116,122,168,76,33,83,181,142,206,241,98,230,152,14,64,16,239,7,6,46,152,101,177,7,27,200,236,78,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_i32(uv, -2147483647)', lines: 1, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,6,8,2,0,0,0,229,173,35,27,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,0,172,73,68,65,84,72,75,237,86,91,14,192,32,8,131,251,31,154,197,144,48,82,240,177,76,191,100,127,171,82,181,20,148,169,190,82,160,163,0,167,184,136,40,206,252,78,16,17,255,75,68,30,177,16,8,132,168,200,188,130,44,174,85,89,222,171,64,98,14,72,185,26,66,83,8,94,1,196,118,102,12,16,21,153,199,136,39,156,174,181,87,151,98,107,130,247,42,30,138,53,214,46,115,139,133,94,226,167,233,232,180,115,104,26,192,79,190,253,164,60,16,85,185,60,161,192,232,90,249,121,137,68,219,125,237,28,102,11,127,114,219,85,106,205,19,26,93,203,153,95,43,49,25,43,175,144,113,35,177,90,143,143,146,41,50,110,99,215,38,239,244,193,31,37,161,180,7,48,43,125,252,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_f32(uv, 0)', lines: 1, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,6,8,2,0,0,0,229,173,35,27,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,0,75,73,68,65,84,72,75,237,150,65,10,0,48,8,195,236,255,31,221,49,58,156,23,127,144,30,4,241,22,130,170,34,16,88,8,168,170,108,103,42,221,150,64,224,249,16,51,162,133,109,252,192,140,38,160,8,49,43,116,32,240,55,71,175,13,46,11,90,76,2,252,28,248,176,18,56,178,126,27,7,62,246,204,28,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_f32(uv, 123.456)', lines: 1, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,6,8,2,0,0,0,229,173,35,27,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,0,179,73,68,65,84,72,75,237,86,91,10,192,48,8,155,247,63,116,71,113,184,224,139,176,245,211,125,117,98,85,98,26,149,107,190,65,160,64,64,212,190,214,18,121,206,250,171,118,51,70,75,26,16,227,216,21,12,197,68,78,115,157,170,112,152,192,35,176,9,161,205,64,30,184,179,107,57,210,8,51,53,113,82,10,186,212,154,5,131,88,222,83,21,242,184,140,231,166,68,213,182,40,39,169,197,64,180,214,70,177,49,230,161,150,168,27,222,170,206,100,133,164,182,77,215,121,4,186,177,210,104,73,76,144,14,145,158,58,170,19,198,18,229,16,163,22,140,218,241,16,140,103,133,192,59,86,210,247,29,141,110,53,113,35,166,218,57,154,221,229,195,22,66,110,51,211,245,159,8,220,118,147,216,7,72,110,191,140,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_f32(uv, 0.001)', lines: 1, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,6,8,2,0,0,0,229,173,35,27,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,0,121,73,68,65,84,72,75,237,86,65,10,192,48,8,51,255,127,116,70,113,200,54,117,244,90,137,135,66,173,150,54,9,42,76,38,4,26,4,96,102,36,253,20,88,219,210,114,76,153,69,242,231,18,177,112,22,2,112,142,157,209,142,218,28,83,102,61,157,103,161,160,215,150,8,44,113,0,175,53,199,229,152,46,75,149,99,146,206,110,89,68,115,41,155,66,80,30,181,33,123,28,20,137,99,148,56,186,153,227,67,243,206,204,177,51,187,76,194,110,252,95,46,176,51,99,7,81,158,26,176,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_f32(uv, 100)', lines: 1, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,6,8,2,0,0,0,229,173,35,27,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,0,103,73,68,65,84,72,75,237,150,81,10,0,32,8,67,243,254,135,54,98,97,98,214,1,156,125,68,142,126,92,143,165,140,94,237,192,195,1,129,174,170,34,251,140,18,186,137,183,210,150,150,119,96,1,129,135,15,28,160,4,52,254,66,192,168,188,65,204,13,38,201,97,64,0,139,116,103,182,140,167,247,39,28,62,81,44,45,66,198,240,216,196,217,233,249,86,254,19,70,207,28,132,124,76,49,235,69,7,3,176,212,11,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_f32(uv, 100.001)', lines: 1, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,6,8,2,0,0,0,229,173,35,27,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,0,185,73,68,65,84,72,75,237,150,225,14,128,32,8,132,243,253,31,218,230,104,215,141,19,83,215,250,19,253,202,27,10,226,39,82,142,252,50,3,65,6,138,233,181,214,82,174,127,27,154,14,81,21,93,112,102,214,91,54,46,102,44,171,97,243,190,18,131,165,12,52,32,44,179,142,3,27,26,52,108,224,48,130,51,181,153,84,216,175,249,122,84,186,49,43,4,110,95,75,121,73,227,134,132,86,14,0,129,163,82,165,91,54,6,246,209,154,92,165,0,40,151,1,48,10,143,206,11,226,103,3,70,54,43,199,54,232,33,28,124,59,113,155,7,119,81,109,102,20,142,91,107,82,164,68,143,72,4,250,118,118,126,62,241,126,86,198,29,70,183,231,216,232,84,62,232,57,150,250,164,159,31,255,120,251,39,165,64,255,7,224,252,246,80,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_f32(uv, 1.175494351E-38)', lines: 1, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,6,8,2,0,0,0,229,173,35,27,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,0,192,73,68,65,84,72,75,237,150,203,18,192,48,4,69,227,255,63,90,23,58,170,87,136,62,118,209,85,199,120,36,28,130,70,127,157,129,32,3,36,114,102,38,58,255,163,92,89,29,102,182,106,68,228,37,83,207,170,102,195,249,232,32,241,86,32,137,162,195,93,150,126,154,147,91,89,133,140,49,70,14,71,162,35,133,156,226,5,86,128,151,68,244,158,151,86,222,207,11,184,225,204,21,15,187,161,243,114,114,104,154,52,167,182,119,181,234,30,26,80,243,96,229,168,1,193,121,116,152,109,254,204,138,230,178,55,118,195,66,238,251,9,142,168,219,180,192,81,121,244,33,171,60,79,149,121,83,233,251,124,222,84,60,236,134,200,53,216,161,123,42,175,62,236,13,154,187,100,159,248,101,231,168,32,53,45,100,239,28,143,248,62,0,200,248,234,7,29,124,9,37,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_f32(uv, 3.402823466E+38)', lines: 1, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,6,8,2,0,0,0,229,173,35,27,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,0,165,73,68,65,84,72,75,237,86,73,14,192,32,8,132,255,63,154,166,33,177,132,41,46,68,79,226,73,17,16,25,152,192,84,171,50,16,100,128,137,72,68,244,150,249,61,70,75,68,172,2,90,29,146,52,183,46,200,68,60,85,6,75,25,96,155,98,151,110,235,72,17,106,197,97,143,106,133,126,78,72,92,72,54,30,183,159,252,215,82,178,110,83,254,168,162,95,25,29,248,177,131,93,13,33,39,225,91,29,137,101,14,245,28,113,137,94,13,95,191,13,227,244,127,167,152,3,193,104,24,56,10,113,236,130,157,141,12,180,164,83,204,145,70,58,97,24,206,28,195,230,118,19,198,111,55,111,209,169,153,35,129,235,22,147,7,101,209,237,7,107,118,81,82,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_f32(uv, u32tof32(2143289344u))', lines: 1, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,6,8,2,0,0,0,229,173,35,27,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,0,106,73,68,65,84,72,75,237,150,81,10,192,48,12,66,231,253,15,237,40,1,91,146,110,7,16,251,81,74,205,79,30,98,130,39,39,4,62,8,128,36,128,82,245,38,89,63,37,93,107,130,212,158,192,50,71,51,193,180,194,172,177,231,146,6,151,43,202,10,237,62,209,76,85,73,19,130,222,4,246,88,81,60,92,147,67,243,69,49,227,205,37,221,237,228,56,119,142,31,115,180,253,35,4,189,9,188,72,210,90,7,177,178,173,26,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_f32(uv, u32tof32(4294967294u))', lines: 1, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,6,8,2,0,0,0,229,173,35,27,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,0,113,73,68,65,84,72,75,237,150,193,10,192,48,8,67,151,255,255,232,236,96,9,67,109,217,217,166,135,82,212,75,30,33,21,143,143,9,108,8,160,214,73,2,171,174,55,201,152,140,86,59,99,200,195,8,244,230,72,38,168,86,8,175,84,163,12,163,115,185,28,40,18,20,12,97,133,116,127,49,213,174,146,230,114,154,195,228,159,190,21,197,67,155,28,138,13,69,200,48,52,150,243,107,231,56,152,35,237,31,6,58,137,192,11,244,89,93,7,200,100,66,170,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_f32(uv, u32tof32(2139095040u))', lines: 1, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,6,8,2,0,0,0,229,173,35,27,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,0,99,73,68,65,84,72,75,237,150,65,10,0,32,8,4,221,255,63,218,14,27,139,69,65,231,220,14,81,104,7,135,193,68,120,153,192,133,0,34,34,51,25,5,230,149,7,134,0,40,161,166,25,233,247,4,22,9,36,196,38,10,21,249,158,133,11,220,8,156,229,96,183,168,187,158,217,146,62,14,93,229,208,119,35,69,250,64,113,165,115,126,120,156,57,220,48,26,26,51,0,198,228,63,7,93,92,105,104,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_f32(uv, u32tof32(4286578688u))', lines: 1, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,6,8,2,0,0,0,229,173,35,27,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,0,110,73,68,65,84,72,75,237,150,81,10,192,32,12,67,205,253,15,157,33,197,40,91,133,225,103,141,31,82,74,16,250,8,177,104,62,38,176,33,128,180,79,50,250,64,23,144,140,66,181,4,171,204,144,139,17,200,205,241,53,196,203,40,171,93,138,17,241,56,34,128,93,6,164,105,1,116,125,220,243,137,17,42,198,90,140,192,223,228,208,255,18,17,226,228,40,230,131,116,156,243,157,67,91,200,13,152,238,156,241,1,88,152,66,7,17,143,227,201,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_vec2_bool(uv, vec2(true, false))', lines: 2, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,12,8,2,0,0,0,68,54,0,125,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,0,246,73,68,65,84,88,71,237,88,91,14,196,32,8,212,251,31,154,77,131,97,13,35,134,54,141,27,178,211,143,166,181,168,56,76,121,245,198,139,8,4,8,244,214,154,136,232,215,222,175,87,188,76,192,196,230,17,157,37,34,54,93,159,113,22,173,80,11,129,97,66,52,240,146,34,206,252,42,99,84,64,114,68,108,171,133,209,223,106,123,145,67,255,114,187,71,88,56,223,96,98,25,207,65,150,84,100,216,160,133,5,151,141,21,151,129,35,233,75,42,66,67,157,83,57,199,28,62,220,179,38,22,230,60,230,220,133,57,71,117,122,173,51,208,234,167,162,254,175,32,48,200,49,135,140,76,181,130,53,206,114,5,87,212,208,151,188,98,179,99,139,124,195,74,50,219,136,66,12,146,35,51,114,236,156,220,232,1,2,183,61,135,75,47,230,206,7,210,203,117,80,176,59,242,64,99,78,57,134,64,150,28,206,240,251,202,37,234,145,236,131,215,177,51,115,163,36,2,169,106,101,31,32,176,31,138,222,37,242,55,73,45,41,246,19,4,62,20,18,207,13,161,51,129,252,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_vec2_f32(uv, vec2<f32>(1, 22))', lines: 2, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,12,8,2,0,0,0,68,54,0,125,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,0,174,73,68,65,84,88,71,237,152,75,14,192,32,8,68,225,254,135,166,49,24,181,49,124,182,194,184,104,210,214,69,231,57,25,160,76,88,32,96,16,96,34,18,17,125,203,60,110,173,37,34,254,6,64,46,70,128,213,25,122,234,206,241,159,219,138,33,128,28,139,192,48,7,243,239,138,228,128,93,102,37,89,105,17,102,3,202,74,55,211,100,123,142,100,95,210,13,95,109,189,94,7,90,91,57,212,133,4,166,57,194,146,113,39,7,178,36,132,251,250,134,93,86,156,49,245,180,206,217,192,170,248,208,88,175,51,106,251,253,217,228,176,124,0,103,20,182,78,214,28,247,44,19,78,55,133,169,53,145,150,154,86,86,123,177,126,164,222,79,154,240,106,37,243,3,240,13,93,13,166,51,99,8,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_vec2_i32(uv, vec2<i32>(1, 22))', lines: 2, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,12,8,2,0,0,0,68,54,0,125,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,0,174,73,68,65,84,88,71,237,152,75,14,192,32,8,68,225,254,135,166,49,24,181,49,124,182,194,184,104,210,214,69,231,57,25,160,76,88,32,96,16,96,34,18,17,125,203,60,110,173,37,34,254,6,64,46,70,128,213,25,122,234,206,241,159,219,138,33,128,28,139,192,48,7,243,239,138,228,128,93,102,37,89,105,17,102,3,202,74,55,211,100,123,142,100,95,210,13,95,109,189,94,7,90,91,57,212,133,4,166,57,194,146,113,39,7,178,36,132,251,250,134,93,86,156,49,245,180,206,217,192,170,248,208,88,175,51,106,251,253,217,228,176,124,0,103,20,182,78,214,28,247,44,19,78,55,133,169,53,145,150,154,86,86,123,177,126,164,222,79,154,240,106,37,243,3,240,13,93,13,166,51,99,8,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_vec2_u32(uv, vec2<u32>(1, 22))', lines: 2, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,12,8,2,0,0,0,68,54,0,125,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,0,174,73,68,65,84,88,71,237,152,75,14,192,32,8,68,225,254,135,166,49,24,181,49,124,182,194,184,104,210,214,69,231,57,25,160,76,88,32,96,16,96,34,18,17,125,203,60,110,173,37,34,254,6,64,46,70,128,213,25,122,234,206,241,159,219,138,33,128,28,139,192,48,7,243,239,138,228,128,93,102,37,89,105,17,102,3,202,74,55,211,100,123,142,100,95,210,13,95,109,189,94,7,90,91,57,212,133,4,166,57,194,146,113,39,7,178,36,132,251,250,134,93,86,156,49,245,180,206,217,192,170,248,208,88,175,51,106,251,253,217,228,176,124,0,103,20,182,78,214,28,247,44,19,78,55,133,169,53,145,150,154,86,86,123,177,126,164,222,79,154,240,106,37,243,3,240,13,93,13,166,51,99,8,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_vec3_bool(uv, vec3(true, false, true))', lines: 3, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,18,8,2,0,0,0,125,234,99,150,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,1,81,73,68,65,84,104,67,237,90,91,14,132,32,12,132,251,31,26,99,48,181,105,1,199,23,166,113,252,216,184,110,129,50,29,251,98,115,226,69,4,58,8,228,148,82,41,165,254,154,243,250,213,95,34,32,98,250,73,29,85,74,145,225,245,222,143,162,21,98,33,176,153,208,27,184,73,17,99,254,42,35,84,240,228,232,177,45,22,70,191,213,118,37,71,125,203,229,179,135,133,241,13,34,134,120,14,178,36,34,195,54,90,72,112,25,88,177,25,56,64,95,18,17,26,234,12,229,28,58,124,152,251,154,88,136,243,208,185,11,115,142,232,244,106,103,160,209,119,69,253,31,65,96,35,135,14,25,72,181,226,107,156,230,12,166,168,161,47,121,196,102,211,38,217,195,10,152,109,244,66,140,39,7,242,100,218,62,185,208,5,4,78,123,14,147,94,232,206,135,167,151,233,160,248,238,200,5,141,57,100,26,2,40,57,140,225,199,149,75,175,71,50,14,94,211,246,204,133,64,4,160,106,101,28,32,124,63,212,123,151,158,191,1,181,164,216,39,8,176,90,249,4,246,24,139,162,158,67,239,198,156,155,32,29,210,193,193,77,12,156,126,169,229,222,33,53,135,103,189,188,1,169,86,144,102,252,47,209,14,182,233,61,172,28,102,139,60,91,9,102,219,219,234,66,125,14,220,91,104,201,67,182,221,86,158,19,188,139,192,137,127,93,248,242,213,28,215,13,186,26,204,57,222,53,227,59,179,47,251,180,50,34,175,210,252,72,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_vec3_f32(uv, vec3<f32>(1, 22, 333))', lines: 3, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,18,8,2,0,0,0,125,234,99,150,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,0,248,73,68,65,84,104,67,237,89,75,10,197,48,8,140,247,63,180,143,146,144,166,248,252,20,186,81,167,139,66,83,23,153,201,160,142,161,129,7,12,40,12,208,24,131,153,231,95,162,235,83,123,152,217,14,0,201,197,24,160,169,140,121,234,198,241,159,97,197,40,0,28,141,129,75,28,68,143,55,50,7,228,178,42,201,206,22,110,110,64,89,233,38,154,104,207,17,236,75,186,209,87,27,175,213,129,214,70,14,116,46,3,75,28,110,201,144,153,3,185,196,37,55,123,192,93,86,12,155,122,74,231,108,96,39,120,87,88,217,57,106,187,255,104,230,208,116,0,101,20,150,78,84,28,210,203,184,238,166,48,107,77,160,133,220,202,110,47,246,32,85,174,52,225,171,21,76,184,149,86,199,253,14,108,40,115,252,189,127,129,127,121,199,116,194,232,53,56,183,125,71,196,173,200,152,132,108,96,203,15,6,238,178,18,241,29,50,38,178,2,202,147,50,240,217,156,3,153,35,169,2,140,109,175,43,251,29,161,141,194,34,29,6,102,166,197,244,241,3,154,97,174,19,58,173,110,152,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_vec3_i32(uv, vec3<i32>(1, 22, 333))', lines: 3, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,18,8,2,0,0,0,125,234,99,150,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,0,248,73,68,65,84,104,67,237,89,75,10,197,48,8,140,247,63,180,143,146,144,166,248,252,20,186,81,167,139,66,83,23,153,201,160,142,161,129,7,12,40,12,208,24,131,153,231,95,162,235,83,123,152,217,14,0,201,197,24,160,169,140,121,234,198,241,159,97,197,40,0,28,141,129,75,28,68,143,55,50,7,228,178,42,201,206,22,110,110,64,89,233,38,154,104,207,17,236,75,186,209,87,27,175,213,129,214,70,14,116,46,3,75,28,110,201,144,153,3,185,196,37,55,123,192,93,86,12,155,122,74,231,108,96,39,120,87,88,217,57,106,187,255,104,230,208,116,0,101,20,150,78,84,28,210,203,184,238,166,48,107,77,160,133,220,202,110,47,246,32,85,174,52,225,171,21,76,184,149,86,199,253,14,108,40,115,252,189,127,129,127,121,199,116,194,232,53,56,183,125,71,196,173,200,152,132,108,96,203,15,6,238,178,18,241,29,50,38,178,2,202,147,50,240,217,156,3,153,35,169,2,140,109,175,43,251,29,161,141,194,34,29,6,102,166,197,244,241,3,154,97,174,19,58,173,110,152,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_vec3_u32(uv, vec3<u32>(1, 22, 333))', lines: 3, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,18,8,2,0,0,0,125,234,99,150,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,0,248,73,68,65,84,104,67,237,89,75,10,197,48,8,140,247,63,180,143,146,144,166,248,252,20,186,81,167,139,66,83,23,153,201,160,142,161,129,7,12,40,12,208,24,131,153,231,95,162,235,83,123,152,217,14,0,201,197,24,160,169,140,121,234,198,241,159,97,197,40,0,28,141,129,75,28,68,143,55,50,7,228,178,42,201,206,22,110,110,64,89,233,38,154,104,207,17,236,75,186,209,87,27,175,213,129,214,70,14,116,46,3,75,28,110,201,144,153,3,185,196,37,55,123,192,93,86,12,155,122,74,231,108,96,39,120,87,88,217,57,106,187,255,104,230,208,116,0,101,20,150,78,84,28,210,203,184,238,166,48,107,77,160,133,220,202,110,47,246,32,85,174,52,225,171,21,76,184,149,86,199,253,14,108,40,115,252,189,127,129,127,121,199,116,194,232,53,56,183,125,71,196,173,200,152,132,108,96,203,15,6,238,178,18,241,29,50,38,178,2,202,147,50,240,217,156,3,153,35,169,2,140,109,175,43,251,29,161,141,194,34,29,6,102,166,197,244,241,3,154,97,174,19,58,173,110,152,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_vec4_bool(uv, vec4(true, false, true, false))', lines: 4, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,24,8,2,0,0,0,220,113,64,240,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,1,153,73,68,65,84,104,67,237,90,217,14,195,32,12,131,255,255,104,166,138,42,69,9,80,247,128,42,195,125,152,186,142,35,56,94,206,198,192,139,8,52,16,136,33,132,148,82,254,53,198,237,171,189,100,128,12,43,159,228,89,41,37,153,158,239,237,44,106,193,23,2,187,10,173,130,171,20,81,234,207,99,132,10,150,28,45,182,249,194,104,89,105,55,114,228,127,185,124,182,176,80,182,65,134,33,150,131,44,241,200,176,157,22,226,92,58,90,172,58,14,208,150,120,132,134,50,67,49,71,233,62,212,125,14,44,196,120,148,177,11,99,14,239,244,170,71,160,222,79,69,249,95,65,96,39,71,233,50,144,108,197,230,56,213,21,84,82,67,91,242,138,206,166,45,114,184,21,48,218,104,185,24,75,14,228,201,180,115,114,163,27,8,92,182,28,42,188,40,43,31,150,94,170,130,98,171,35,55,36,230,148,105,8,160,228,80,138,239,103,46,173,26,73,223,121,77,59,51,55,2,17,128,178,149,190,131,176,245,80,107,93,90,246,6,148,146,195,62,65,128,217,202,39,176,251,216,20,181,28,229,105,84,223,4,169,144,118,26,55,62,112,90,82,202,163,66,170,154,103,173,184,1,201,86,144,98,252,146,104,59,59,244,225,86,78,163,69,246,86,156,233,246,177,184,80,157,3,183,22,229,200,83,182,61,22,158,11,140,69,224,194,91,23,54,125,85,237,186,78,85,131,49,199,88,53,142,89,157,217,202,24,92,255,98,213,155,217,10,123,43,127,161,253,147,67,64,217,10,88,4,235,84,81,109,212,178,2,184,222,207,8,101,43,213,55,70,109,229,131,189,21,239,108,80,242,15,180,28,229,78,172,124,120,228,13,26,115,32,141,55,57,63,123,43,30,169,96,101,254,1,43,182,155,40,60,21,201,199,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_vec4_f32(uv, vec4<f32>(1, 22, 333, 4444))', lines: 4, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,24,8,2,0,0,0,220,113,64,240,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,1,69,73,68,65,84,104,67,237,89,209,10,196,32,12,179,255,255,209,142,161,56,135,83,35,19,164,109,246,112,112,187,222,102,98,104,155,42,129,23,25,232,48,32,33,132,24,99,250,85,228,254,218,187,98,140,227,0,146,108,140,1,73,202,72,187,62,216,254,58,204,24,5,132,211,99,224,22,135,200,235,147,153,131,114,201,149,164,100,139,105,110,96,89,241,38,26,180,231,0,251,18,111,244,217,198,59,234,64,109,35,39,186,41,3,89,28,211,146,209,102,14,230,146,41,185,218,3,158,178,50,176,169,181,116,234,6,54,129,159,10,75,59,71,110,215,143,102,142,158,14,168,12,195,210,65,197,209,122,153,169,187,49,204,154,19,104,144,91,41,237,69,25,164,182,119,156,240,229,10,38,221,138,171,237,94,3,11,101,142,207,243,23,250,151,53,166,21,70,231,193,249,216,119,32,110,165,141,81,200,6,151,252,98,224,41,43,136,239,104,99,144,59,164,92,41,3,219,230,28,204,28,74,21,48,88,118,62,178,47,17,189,81,24,210,97,112,102,106,76,31,116,43,198,54,116,39,28,212,173,124,142,201,145,134,3,105,101,118,2,226,179,246,49,0,185,149,98,101,235,162,131,204,76,57,69,221,183,83,7,158,4,185,149,222,97,219,170,197,61,128,143,175,252,193,0,148,57,144,241,57,18,243,99,157,252,235,1,6,216,115,28,32,93,203,43,47,84,131,11,40,144,24,69,101,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_vec4_i32(uv, vec4<i32>(1, 22, 333, 4444))', lines: 4, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,24,8,2,0,0,0,220,113,64,240,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,1,69,73,68,65,84,104,67,237,89,209,10,196,32,12,179,255,255,209,142,161,56,135,83,35,19,164,109,246,112,112,187,222,102,98,104,155,42,129,23,25,232,48,32,33,132,24,99,250,85,228,254,218,187,98,140,227,0,146,108,140,1,73,202,72,187,62,216,254,58,204,24,5,132,211,99,224,22,135,200,235,147,153,131,114,201,149,164,100,139,105,110,96,89,241,38,26,180,231,0,251,18,111,244,217,198,59,234,64,109,35,39,186,41,3,89,28,211,146,209,102,14,230,146,41,185,218,3,158,178,50,176,169,181,116,234,6,54,129,159,10,75,59,71,110,215,143,102,142,158,14,168,12,195,210,65,197,209,122,153,169,187,49,204,154,19,104,144,91,41,237,69,25,164,182,119,156,240,229,10,38,221,138,171,237,94,3,11,101,142,207,243,23,250,151,53,166,21,70,231,193,249,216,119,32,110,165,141,81,200,6,151,252,98,224,41,43,136,239,104,99,144,59,164,92,41,3,219,230,28,204,28,74,21,48,88,118,62,178,47,17,189,81,24,210,97,112,102,106,76,31,116,43,198,54,116,39,28,212,173,124,142,201,145,134,3,105,101,118,2,226,179,246,49,0,185,149,98,101,235,162,131,204,76,57,69,221,183,83,7,158,4,185,149,222,97,219,170,197,61,128,143,175,252,193,0,148,57,144,241,57,18,243,99,157,252,235,1,6,216,115,28,32,93,203,43,47,84,131,11,40,144,24,69,101,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_vec4_u32(uv, vec4<u32>(1, 22, 333, 4444))', lines: 4, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,24,8,2,0,0,0,220,113,64,240,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,1,69,73,68,65,84,104,67,237,89,209,10,196,32,12,179,255,255,209,142,161,56,135,83,35,19,164,109,246,112,112,187,222,102,98,104,155,42,129,23,25,232,48,32,33,132,24,99,250,85,228,254,218,187,98,140,227,0,146,108,140,1,73,202,72,187,62,216,254,58,204,24,5,132,211,99,224,22,135,200,235,147,153,131,114,201,149,164,100,139,105,110,96,89,241,38,26,180,231,0,251,18,111,244,217,198,59,234,64,109,35,39,186,41,3,89,28,211,146,209,102,14,230,146,41,185,218,3,158,178,50,176,169,181,116,234,6,54,129,159,10,75,59,71,110,215,143,102,142,158,14,168,12,195,210,65,197,209,122,153,169,187,49,204,154,19,104,144,91,41,237,69,25,164,182,119,156,240,229,10,38,221,138,171,237,94,3,11,101,142,207,243,23,250,151,53,166,21,70,231,193,249,216,119,32,110,165,141,81,200,6,151,252,98,224,41,43,136,239,104,99,144,59,164,92,41,3,219,230,28,204,28,74,21,48,88,118,62,178,47,17,189,81,24,210,97,112,102,106,76,31,116,43,198,54,116,39,28,212,173,124,142,201,145,134,3,105,101,118,2,226,179,246,49,0,185,149,98,101,235,162,131,204,76,57,69,221,183,83,7,158,4,185,149,222,97,219,170,197,61,128,143,175,252,193,0,148,57,144,241,57,18,243,99,157,252,235,1,6,216,115,28,32,93,203,43,47,84,131,11,40,144,24,69,101,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_ascii_u32(uv, 84)', lines: 1, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,6,8,2,0,0,0,229,173,35,27,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,0,61,73,68,65,84,72,75,237,210,33,14,0,32,0,3,49,246,255,71,15,1,130,144,32,240,157,157,187,52,195,20,120,20,72,219,243,74,162,149,2,171,192,166,208,22,11,38,174,2,112,32,241,44,0,7,28,112,48,240,95,96,2,241,64,15,7,150,218,83,1,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_ascii5_u32(uv, array<u32, 5>(84, 82, 85, 69, 32))', lines: 1, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,6,8,2,0,0,0,229,173,35,27,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,0,110,73,68,65,84,72,75,237,150,49,14,192,48,8,3,241,255,31,237,14,180,40,9,165,234,108,57,19,2,101,224,176,12,8,63,19,24,8,128,228,90,2,182,12,128,136,32,153,65,197,253,151,9,235,17,216,70,190,142,255,144,66,23,71,101,244,160,184,163,36,240,46,142,162,243,199,57,172,18,85,49,141,206,209,87,201,228,37,170,104,220,215,215,90,201,195,162,204,227,182,154,231,10,57,46,21,163,212,35,112,1,97,189,81,7,37,3,150,148,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_ascii5_u32(uv - vec2f(1, 1), array<u32, 5>(84, 82, 85, 69, 32))', lines: 3, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,18,8,2,0,0,0,125,234,99,150,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,0,194,73,68,65,84,104,67,237,151,65,10,128,48,12,4,155,255,63,58,34,133,80,90,3,77,78,11,142,167,26,72,221,238,14,81,109,112,225,64,226,128,225,12,14,100,14,0,7,108,164,14,0,7,112,0,7,12,212,29,96,114,212,61,251,77,7,112,252,38,234,250,65,63,224,112,247,117,31,51,91,43,102,111,139,187,207,69,172,207,174,186,24,58,180,28,72,39,199,25,255,134,194,9,71,84,180,142,136,154,174,3,183,112,196,254,55,147,3,74,186,113,104,245,221,194,49,95,46,219,180,200,102,137,214,17,81,211,117,160,0,199,252,188,24,99,196,240,152,15,221,110,215,98,87,21,125,18,14,240,183,34,17,131,166,8,224,208,204,69,66,21,112,72,196,160,41,2,56,52,115,145,80,5,28,18,49,104,138,0,14,205,92,36,84,61,80,8,81,19,67,78,168,200,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_mat2x2_f32(uv, mat2x2<f32>(1, 2, 3, 4))', lines: 4, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,24,8,2,0,0,0,220,113,64,240,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,1,96,73,68,65,84,104,67,237,90,237,14,195,32,8,212,247,127,232,46,139,141,35,224,199,185,154,84,244,246,171,107,137,133,131,224,157,52,6,254,136,64,5,129,24,66,184,174,43,61,141,241,254,155,46,210,163,124,83,218,212,240,204,246,4,124,3,4,98,170,12,85,22,41,199,170,50,108,233,168,248,229,82,27,64,195,16,238,10,80,213,32,123,70,190,182,54,22,62,118,142,157,74,170,213,30,100,231,144,155,75,222,116,88,28,59,149,130,141,101,38,231,80,220,101,111,224,78,136,238,38,158,39,132,202,24,71,17,64,59,135,98,33,197,215,176,115,140,162,191,184,61,164,86,178,220,5,217,6,105,233,226,89,7,221,131,212,138,58,243,104,47,205,202,0,161,95,223,12,82,43,96,113,240,156,99,253,124,15,121,136,114,142,46,159,200,6,200,65,234,144,139,52,126,11,1,170,149,183,144,119,240,94,61,67,41,158,141,218,249,11,213,138,131,220,62,118,241,183,173,72,37,242,199,108,69,242,80,114,210,199,121,89,98,129,66,231,176,244,83,214,74,55,241,93,131,37,226,166,19,0,2,229,226,176,157,163,59,91,97,231,0,208,118,102,50,77,173,128,188,196,25,60,103,187,75,181,114,118,254,155,209,163,106,5,153,173,128,54,204,134,23,4,32,181,130,204,86,64,27,47,184,208,207,239,247,129,181,163,113,43,58,218,50,4,249,78,140,136,251,66,0,82,43,200,108,133,199,231,190,18,143,120,59,83,173,144,115,32,136,59,178,249,0,25,210,92,40,33,110,89,217,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_mat2x3_f32(uv, mat2x3<f32>(1, 2, 3, 4, 5, 6))', lines: 6, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,36,8,2,0,0,0,175,201,135,38,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,1,232,73,68,65,84,120,94,237,92,217,14,195,32,12,43,255,255,209,157,38,42,150,133,203,84,244,114,189,167,29,140,98,199,74,99,194,22,22,61,196,64,133,129,176,44,203,186,174,241,211,16,182,151,241,73,252,40,189,105,199,212,248,76,227,69,56,1,3,33,42,195,201,34,198,216,41,35,151,142,195,111,167,34,160,70,16,54,5,56,53,216,156,145,158,231,99,114,250,148,57,152,36,213,74,15,54,115,216,155,75,186,233,72,28,76,82,200,177,204,172,57,92,237,194,77,220,27,208,109,133,231,27,160,10,227,40,3,104,230,112,85,72,241,50,202,28,163,236,223,124,60,228,86,146,221,5,171,13,149,165,55,143,58,184,60,200,173,184,61,143,246,212,82,6,72,253,253,135,65,110,5,20,135,246,57,238,31,239,161,21,162,53,71,183,158,72,3,144,141,212,161,37,106,240,85,12,200,173,92,197,252,3,174,59,45,115,228,61,154,7,160,215,18,155,12,64,110,165,216,127,113,211,218,58,84,53,41,135,234,32,183,98,187,42,221,192,119,7,112,16,247,6,20,144,91,41,182,103,149,57,232,245,161,154,131,62,196,251,1,202,173,236,231,142,254,155,254,196,87,241,36,7,184,9,134,244,95,232,9,101,2,248,187,173,216,190,73,241,236,79,58,48,86,195,175,29,82,38,101,124,195,93,203,10,185,233,104,219,16,228,156,24,25,119,244,112,202,226,40,70,186,43,14,75,86,163,127,75,207,41,13,192,153,110,69,53,7,141,44,182,6,25,25,30,193,153,200,0,234,86,212,149,157,72,250,83,166,130,220,202,104,111,229,41,224,181,206,54,3,144,91,65,122,43,246,60,135,170,81,14,217,65,110,5,233,173,88,58,212,123,227,17,199,148,223,202,42,115,112,8,226,111,63,130,15,146,16,205,98,0,117,43,200,30,70,215,209,204,90,180,230,57,135,1,200,173,140,254,110,229,156,165,235,42,71,51,0,185,149,90,255,197,21,161,233,165,220,202,209,97,59,103,126,200,173,128,226,200,255,242,229,28,12,186,202,65,12,204,236,173,168,230,56,40,72,87,77,251,1,169,186,7,67,5,37,118,219,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_mat3x2_f32(uv, mat3x2<f32>(1, 2, 3, 4, 5, 6))', lines: 6, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,36,8,2,0,0,0,175,201,135,38,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,2,22,73,68,65,84,120,94,237,91,219,178,196,32,8,171,255,255,209,221,7,59,150,1,43,113,122,89,212,156,167,61,91,214,66,96,104,34,54,109,252,35,2,23,8,164,109,219,246,125,207,87,83,58,254,205,31,242,165,242,165,180,185,194,179,216,19,240,9,16,72,185,50,84,89,228,28,171,202,176,165,163,226,151,75,77,0,13,67,56,42,64,85,131,236,25,229,179,181,177,240,177,115,204,84,82,173,246,32,59,135,124,184,148,135,14,139,99,166,82,176,177,60,201,57,20,119,153,27,184,21,162,59,136,231,10,161,50,198,94,4,208,206,161,88,72,245,54,236,28,189,232,7,183,135,212,74,145,187,32,219,32,45,13,158,117,208,61,72,173,168,61,143,246,210,172,12,16,250,248,102,144,90,1,139,131,251,28,241,243,221,229,33,202,57,92,62,81,12,144,141,212,46,23,105,252,47,4,168,86,254,133,252,0,247,213,51,148,234,222,168,157,191,80,173,12,144,219,219,46,158,143,21,169,68,236,108,197,142,226,212,173,37,15,37,39,189,157,151,16,11,84,58,71,131,126,34,89,71,108,66,132,78,39,60,4,234,197,81,157,195,149,225,237,213,51,197,237,46,158,51,188,30,11,1,72,173,128,74,196,85,52,177,66,167,55,30,2,84,43,30,66,11,95,127,82,173,32,243,151,133,161,30,47,116,84,173,84,15,17,90,193,210,230,37,227,193,179,182,199,144,90,145,252,244,74,140,32,231,196,214,134,122,188,232,33,181,82,61,76,90,109,27,229,203,198,252,118,60,144,86,245,24,82,43,224,14,41,57,199,100,85,68,181,50,89,66,159,12,7,237,28,110,87,0,247,66,158,244,157,107,189,140,192,121,158,67,189,194,36,223,91,233,61,9,246,178,207,92,254,35,4,206,199,138,146,33,86,149,180,135,38,178,115,144,141,126,148,189,151,111,3,237,115,100,31,240,137,26,110,249,114,116,92,254,22,2,199,1,99,41,65,171,195,119,119,110,194,206,113,43,15,33,127,76,181,18,50,45,49,156,66,213,138,219,57,240,189,144,24,129,211,11,31,1,72,173,32,167,188,200,51,124,176,71,179,232,80,43,109,78,74,206,49,90,234,125,127,81,181,226,190,147,130,116,23,223,29,90,68,66,0,82,43,224,238,39,194,75,34,197,78,95,28,4,126,116,246,251,52,19,6,223,21,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_mat3x3_f32(uv, mat3x3<f32>(1, 2, 3, 4, 5, 6, 7, 8, 9))', lines: 9, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,54,8,2,0,0,0,225,215,36,182,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,2,207,73,68,65,84,120,94,237,156,235,174,132,32,12,132,245,253,31,218,147,19,13,18,64,248,88,65,176,206,254,218,75,133,118,218,148,78,97,89,23,189,132,192,5,2,235,178,44,219,182,237,191,174,235,241,113,127,179,255,228,190,244,101,174,240,116,242,2,220,0,2,235,30,25,65,88,236,62,14,34,35,14,157,192,126,127,40,3,208,200,132,35,2,130,104,240,115,134,123,31,203,196,240,41,115,88,10,169,92,122,240,51,135,191,184,184,69,71,193,97,41,20,98,91,90,214,28,65,237,98,27,184,47,88,119,20,158,95,48,85,54,214,34,64,51,71,80,133,36,167,81,230,168,69,127,114,121,196,86,28,221,133,213,134,202,210,201,189,14,213,67,108,37,232,121,228,135,86,100,64,232,231,23,67,108,5,6,135,250,28,243,251,187,74,67,90,115,20,235,9,39,64,26,169,85,42,74,120,20,2,98,43,163,144,127,193,188,205,50,71,188,71,243,2,235,165,98,22,1,196,86,252,26,243,170,222,36,50,242,197,187,16,168,96,43,164,213,1,101,222,133,209,103,181,165,108,165,200,68,148,57,236,197,16,170,57,32,19,41,50,26,123,240,217,182,72,108,197,182,127,111,89,23,158,248,74,158,228,224,76,68,237,209,91,222,152,236,225,115,89,241,247,77,116,18,108,50,55,141,81,39,145,57,226,102,185,31,43,121,42,171,204,49,198,141,125,102,77,7,71,156,57,138,39,193,96,209,218,199,10,141,218,5,1,196,86,84,115,116,193,126,250,65,197,86,166,119,209,56,5,41,91,41,182,62,181,172,140,115,98,175,153,17,91,169,61,9,214,75,89,141,251,44,2,136,173,196,252,37,86,210,207,28,153,211,132,207,90,167,217,110,33,128,216,10,9,14,95,11,17,218,91,62,153,230,225,102,108,69,153,99,26,159,54,83,68,108,165,25,148,246,6,162,108,133,236,184,18,25,123,8,26,182,8,177,21,114,86,67,117,134,189,40,169,96,43,249,86,135,106,142,175,4,71,242,70,6,119,141,71,18,5,146,93,236,193,103,219,34,196,86,96,247,83,53,135,177,88,17,91,49,230,208,150,230,160,204,65,118,101,97,118,105,169,187,198,234,140,192,121,250,60,184,30,238,135,59,193,156,170,98,46,157,189,246,208,240,231,178,18,120,52,46,48,201,157,96,197,205,219,135,204,210,52,45,16,168,235,115,84,253,123,165,133,122,26,99,36,2,199,223,33,157,10,254,106,82,123,15,169,86,147,145,158,236,48,183,216,74,7,80,173,12,73,217,10,41,38,212,231,176,18,21,135,29,136,173,212,158,4,211,250,98,35,74,16,91,217,77,45,186,92,153,195,70,76,156,5,104,50,43,36,89,107,62,56,180,183,98,44,50,254,183,210,226,206,102,210,205,36,43,16,25,123,8,26,182,72,108,197,176,115,239,154,70,217,10,201,10,68,230,174,190,122,254,65,4,16,91,33,245,4,145,121,208,46,77,213,0,129,10,182,82,36,44,58,12,214,192,33,51,13,129,246,86,72,159,195,55,170,72,122,103,66,64,186,92,34,128,216,10,60,171,161,154,195,88,160,253,1,230,216,250,85,248,192,105,209,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_mat3x4_f32(uv, mat3x4<f32>(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12))', lines: 12, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,72,8,2,0,0,0,208,255,72,7,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,3,173,73,68,65,84,120,94,237,157,81,142,195,32,12,68,155,251,31,186,171,21,17,69,64,194,35,1,1,102,246,171,219,18,176,199,150,241,24,39,57,62,250,19,2,23,8,28,159,207,231,251,253,186,95,143,227,252,215,125,112,63,249,47,195,49,87,120,250,241,2,220,0,2,135,243,140,200,45,156,141,35,207,72,93,39,210,63,156,202,0,52,82,225,244,128,200,27,194,152,225,63,167,99,82,248,20,57,44,185,212,93,120,8,35,71,184,185,248,77,71,206,97,201,21,82,93,90,230,28,81,238,98,27,184,29,180,59,19,207,29,84,149,142,181,8,208,200,17,101,33,217,101,20,57,106,209,159,124,60,98,43,158,238,194,108,67,105,233,228,86,135,226,33,182,18,213,60,238,167,150,103,64,232,231,31,134,216,10,116,14,213,57,230,183,119,149,132,52,231,40,230,19,126,0,41,164,86,137,168,193,163,16,16,91,25,133,252,2,235,54,139,28,233,25,205,2,218,75,196,91,4,16,91,9,115,204,171,124,147,140,145,45,214,66,160,130,173,144,82,7,28,179,22,70,219,74,75,217,74,145,137,40,114,216,243,33,148,115,64,38,82,100,52,246,224,179,173,145,216,138,109,251,190,210,14,69,14,206,68,84,30,125,101,141,201,46,166,108,37,219,68,24,233,82,204,75,38,211,93,226,20,16,64,108,37,236,1,187,167,178,138,28,150,60,14,177,149,108,51,105,54,108,248,47,111,206,111,45,193,103,91,23,229,28,182,237,251,74,59,177,149,87,240,217,190,56,190,63,37,219,119,238,32,184,207,39,96,45,196,54,154,198,180,251,109,43,97,150,144,189,83,193,19,150,44,4,74,69,141,121,198,191,185,175,162,66,106,108,30,57,148,141,218,112,148,188,115,100,239,95,226,177,129,143,180,1,162,85,45,154,177,149,48,231,80,228,176,225,46,98,43,54,236,216,69,11,202,86,200,137,43,25,211,69,9,77,218,7,1,196,86,72,175,134,242,140,62,6,26,57,107,5,91,185,47,117,40,231,24,105,198,62,107,83,182,82,60,113,37,209,165,143,10,154,181,23,2,136,173,192,234,167,114,142,94,86,26,52,175,216,202,32,224,87,88,182,25,91,129,209,101,5,76,36,227,137,0,101,43,164,19,204,131,42,230,98,195,191,16,91,33,157,96,242,12,27,14,17,106,129,216,10,233,4,187,58,192,179,7,217,62,26,33,182,2,187,207,181,155,24,243,27,177,21,99,6,109,169,14,101,43,197,78,48,24,93,90,202,174,185,58,35,128,216,138,158,9,214,217,10,147,78,143,216,10,76,54,85,33,157,212,200,79,197,66,108,133,56,135,206,86,158,154,96,222,235,26,179,21,167,168,58,193,230,53,120,141,100,98,43,53,104,109,54,86,145,99,51,131,215,168,251,187,87,54,122,245,78,244,190,149,244,245,60,209,42,202,57,106,96,95,99,236,111,91,137,234,155,217,114,167,110,93,89,195,170,141,164,108,86,231,8,229,81,29,189,145,117,6,79,115,62,188,197,75,17,238,38,225,59,154,66,49,175,200,136,234,28,131,141,217,122,121,177,149,214,136,26,154,175,37,91,73,207,95,20,75,150,118,21,202,86,72,39,88,212,161,158,125,239,228,210,96,237,38,60,98,43,188,19,44,37,180,217,123,178,119,67,121,81,125,17,91,121,214,9,198,175,90,20,59,243,98,35,182,2,123,53,210,12,67,57,199,210,14,36,182,178,180,249,250,10,79,217,10,233,4,203,142,81,65,172,175,1,123,206,142,216,10,233,4,203,142,41,222,97,219,83,53,205,253,22,1,196,86,220,34,36,6,212,62,73,236,173,248,186,190,39,2,136,173,200,57,122,154,96,222,185,197,86,230,181,205,112,201,196,86,134,155,96,94,1,40,91,129,21,139,180,41,196,169,174,174,210,121,93,224,90,50,196,86,96,151,87,122,182,82,236,31,91,17,178,125,100,174,96,43,132,176,60,232,31,219,7,235,229,52,165,108,5,86,44,178,219,138,246,148,229,220,226,76,6,210,39,242,100,79,86,67,245,96,39,152,158,245,179,168,79,120,177,255,0,22,64,44,133,244,131,79,16,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_mat4x3_f32(uv, mat4x3<f32>(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12))', lines: 12, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,72,8,2,0,0,0,208,255,72,7,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,3,136,73,68,65,84,120,94,237,157,209,114,132,32,12,69,245,255,63,122,251,224,14,203,0,234,65,83,9,241,246,105,219,141,144,220,100,66,110,0,187,46,250,17,2,59,8,172,203,178,124,62,159,237,219,117,253,254,186,125,216,190,74,127,204,101,246,240,76,242,2,60,0,2,235,22,25,69,88,108,62,46,34,163,14,157,194,254,124,168,0,208,200,132,111,4,20,209,144,231,140,244,185,150,169,225,83,230,136,20,82,71,233,33,207,28,249,226,146,22,29,5,71,164,80,168,109,177,172,57,138,218,37,54,112,111,176,238,91,120,190,193,84,217,216,139,0,205,28,69,21,210,156,70,153,163,23,125,231,242,136,173,36,186,11,171,13,149,165,206,189,14,213,67,108,165,232,121,28,15,173,200,128,208,251,23,67,108,5,6,135,250,28,254,253,221,165,33,173,57,78,235,137,36,64,26,169,93,42,74,120,20,2,98,43,163,144,159,96,94,179,204,81,239,209,76,96,189,84,60,68,0,177,149,188,198,220,171,55,137,140,124,49,23,2,29,108,133,180,58,160,204,92,24,189,86,91,202,86,78,153,136,50,71,188,24,66,53,7,100,34,167,140,38,30,124,177,45,18,91,137,237,223,91,214,149,39,190,154,39,57,56,19,81,123,244,150,55,156,61,252,91,86,242,125,147,250,36,88,125,112,176,54,228,180,46,113,102,187,212,57,65,160,145,57,14,154,229,7,137,129,156,19,147,55,230,66,160,29,28,23,50,7,44,90,231,66,231,229,218,34,182,162,154,227,157,81,34,182,242,78,191,35,171,205,216,138,150,21,132,247,84,66,148,173,52,175,60,229,150,138,196,78,229,119,164,44,98,43,121,125,122,176,241,150,38,60,56,77,136,148,146,144,15,4,250,216,10,236,100,40,139,248,112,238,93,45,204,216,74,94,115,40,115,220,117,139,143,231,197,86,124,248,193,165,22,148,173,144,131,26,218,149,117,233,226,235,74,33,182,210,123,111,229,186,58,122,210,19,2,136,173,28,236,182,36,91,84,115,120,114,171,141,46,136,173,192,224,32,59,183,54,90,107,148,71,16,48,99,43,124,255,229,17,187,52,137,1,2,98,43,6,32,70,29,194,44,115,104,111,37,94,136,252,78,159,23,175,135,43,222,9,214,85,79,168,67,26,35,80,126,203,74,225,209,166,131,137,215,137,76,12,236,194,91,97,214,231,32,140,38,60,154,193,12,252,94,135,76,86,229,171,73,254,30,193,220,236,189,173,19,229,140,104,193,17,204,30,153,99,136,128,25,91,81,159,195,208,43,78,134,50,99,43,186,43,235,196,163,134,106,88,178,21,237,202,26,58,198,195,80,136,173,144,172,64,100,60,24,44,29,56,2,136,173,192,122,66,153,131,227,62,133,164,246,86,166,112,211,24,37,197,86,198,224,62,197,172,148,173,116,221,91,81,55,108,10,223,159,42,137,216,10,185,183,146,215,37,41,146,78,167,151,128,103,4,250,216,138,238,173,120,246,165,185,110,98,43,230,144,198,25,80,108,37,142,47,205,45,161,108,133,220,91,169,101,212,249,48,119,216,147,3,34,182,66,238,173,212,50,205,255,59,249,164,109,154,235,38,2,136,173,108,115,16,130,90,55,209,245,174,176,155,30,26,248,56,205,28,151,131,3,102,157,129,16,104,234,61,4,104,205,65,170,135,90,134,60,37,223,184,69,64,108,197,173,107,198,43,102,153,57,154,75,15,169,84,198,195,32,13,90,8,160,154,3,158,213,168,251,167,176,163,42,215,248,68,160,131,173,144,154,180,206,19,202,28,62,29,79,180,66,153,131,51,14,5,7,1,125,22,25,84,115,192,123,176,98,43,179,120,29,234,41,182,2,129,122,163,24,202,28,240,12,169,246,86,130,69,16,170,57,174,177,21,248,84,48,64,35,153,243,239,108,133,112,156,72,128,70,178,197,50,115,236,45,43,122,103,237,164,17,99,89,115,20,108,5,114,156,73,129,123,131,218,127,149,129,50,133,63,189,183,244,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_mat4x4_f32(uv, mat4x4<f32>(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16))', lines: 16, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,96,8,2,0,0,0,59,0,207,92,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,4,175,73,68,65,84,120,94,237,157,109,143,227,32,12,132,219,255,255,163,123,58,165,98,17,36,240,144,26,197,152,185,79,123,187,46,216,99,203,153,225,165,121,191,244,79,8,92,32,240,126,189,94,159,207,231,248,235,251,253,253,239,241,195,241,167,244,203,220,230,10,207,100,47,192,3,32,240,62,42,163,40,139,35,199,69,101,212,165,83,196,159,15,21,0,26,133,240,173,128,162,26,242,158,145,126,174,109,106,248,212,57,34,149,84,171,61,228,157,35,127,184,164,135,142,138,35,82,41,212,177,88,114,142,130,187,196,6,110,135,232,190,196,115,135,80,21,227,40,2,180,115,20,44,228,116,26,117,142,81,244,157,219,35,181,146,228,46,100,27,162,165,206,179,14,221,67,106,165,88,243,104,15,173,202,128,208,251,55,67,106,5,22,135,214,57,252,231,123,200,67,202,57,186,124,34,25,144,133,212,33,23,101,252,20,2,82,43,79,33,191,192,188,102,157,163,222,163,89,32,122,185,216,68,0,169,149,156,99,94,241,77,98,163,92,172,133,192,128,90,33,75,29,208,102,45,140,182,245,150,170,149,174,18,81,231,136,87,67,136,115,64,37,210,85,52,241,224,139,29,145,212,74,236,252,254,20,29,234,28,92,137,104,121,244,167,108,56,251,176,153,90,33,251,47,206,98,151,59,29,4,204,212,10,57,39,166,108,172,133,0,82,43,68,137,64,210,186,22,58,155,123,43,206,177,121,1,180,194,151,90,81,113,92,34,80,222,79,57,61,119,78,212,138,30,43,241,170,236,239,177,146,159,242,186,113,111,69,34,54,102,113,156,110,136,212,36,180,173,71,242,206,209,56,77,24,15,193,192,17,157,60,86,138,91,76,245,165,200,110,238,213,69,98,84,140,153,90,81,231,136,81,16,121,20,82,43,241,114,106,22,17,85,43,228,160,134,118,101,205,210,226,99,32,164,86,200,190,137,120,134,143,132,90,122,113,78,72,187,250,165,118,65,156,195,50,45,62,198,66,106,229,112,181,221,27,200,254,139,143,144,229,5,69,192,76,173,144,85,84,234,148,236,124,32,32,181,226,35,15,46,189,160,106,165,171,68,180,183,226,50,191,63,57,133,212,202,40,159,144,114,249,41,39,110,62,60,160,86,186,156,148,240,86,55,129,203,145,62,2,84,173,116,239,173,168,50,250,96,175,102,129,212,10,228,19,122,154,172,150,253,142,191,82,43,193,18,106,25,142,153,90,209,58,135,101,90,124,140,101,166,86,70,21,141,143,240,229,69,11,1,75,181,210,93,11,81,42,214,66,0,169,21,210,21,136,205,90,208,200,91,164,86,32,159,80,231,8,86,79,82,43,193,18,106,25,142,58,135,37,154,193,198,250,187,43,91,156,50,31,125,223,138,56,71,176,202,248,255,22,158,20,82,177,190,57,122,111,37,231,37,233,237,62,241,240,218,42,162,177,117,14,237,176,236,85,28,245,190,201,233,3,130,40,17,98,179,21,184,171,7,43,181,178,122,6,39,250,79,213,202,189,195,28,234,37,19,83,55,127,104,164,86,200,189,149,218,230,244,189,147,243,35,210,12,102,8,32,181,114,204,70,142,107,220,208,56,102,161,104,32,107,4,144,90,249,165,56,96,215,177,142,75,227,25,32,240,253,170,201,52,82,190,246,53,250,70,234,154,97,136,115,24,164,232,185,33,164,86,158,195,222,253,204,84,173,192,30,80,243,18,194,84,220,163,180,169,131,72,173,192,125,147,122,253,20,174,168,110,138,189,251,176,7,212,10,17,44,234,28,238,51,62,224,32,85,43,176,7,168,56,6,176,119,111,138,212,10,191,183,114,196,155,190,81,14,50,21,247,40,109,234,160,212,202,166,137,39,97,207,85,43,234,28,36,7,110,109,38,170,21,168,113,220,66,35,199,166,171,21,162,113,148,6,159,8,32,181,194,123,64,125,214,80,71,6,125,38,158,120,133,212,202,189,123,43,80,227,16,47,101,243,8,2,82,43,143,192,190,198,164,82,43,107,228,233,17,47,169,90,73,212,161,177,145,86,172,162,114,166,242,72,228,154,180,139,0,82,43,249,155,86,248,87,213,166,185,181,49,219,77,131,79,3,218,57,142,21,241,238,14,203,85,183,80,125,248,76,127,219,43,75,206,161,147,96,43,86,64,195,103,169,149,96,9,181,12,135,118,14,184,208,169,45,123,203,228,60,61,22,226,28,132,109,156,218,116,57,202,211,225,107,254,22,2,72,173,28,3,16,82,121,117,111,69,73,88,17,1,218,57,238,21,71,142,72,247,157,146,43,194,23,219,103,202,57,200,201,140,83,27,210,111,98,67,188,110,116,82,43,235,230,110,186,231,150,157,163,120,244,104,87,118,122,246,38,79,128,56,7,220,37,105,236,173,76,142,66,195,79,65,96,64,173,16,78,90,148,81,114,89,108,116,74,246,38,15,138,58,7,92,231,104,84,143,104,233,228,60,78,25,30,113,14,200,30,10,181,146,127,74,157,99,74,246,38,15,42,181,50,25,224,149,135,71,157,3,158,33,173,31,43,100,117,100,101,244,130,251,142,56,135,212,74,240,42,184,8,79,106,101,207,188,163,168,45,59,71,189,8,150,223,168,22,39,69,9,241,100,100,201,57,116,18,204,83,102,13,124,249,7,229,148,196,172,54,38,20,62,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_mat4x2_f32(uv, mat4x2<f32>(1, 2, 3, 4, 5, 6, 7, 8))', lines: 8, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,48,8,2,0,0,0,55,142,199,171,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,2,123,73,68,65,84,120,94,237,91,209,142,196,32,8,108,255,255,163,123,185,216,88,163,86,198,173,173,128,115,79,123,91,86,97,32,200,128,221,55,254,17,129,27,4,246,109,219,142,227,8,79,247,253,252,55,124,8,143,226,151,169,204,29,158,81,158,128,59,64,96,15,145,145,133,69,240,113,22,25,101,232,100,246,167,75,57,128,134,38,156,17,144,69,67,154,51,226,231,82,166,132,143,153,195,83,72,181,210,67,154,57,210,195,37,30,58,12,14,79,161,80,218,50,178,230,200,106,23,223,192,173,96,221,89,120,174,96,42,109,236,69,0,205,28,89,21,82,221,134,153,163,23,125,229,242,16,91,137,116,23,172,54,88,150,42,247,58,168,30,196,86,178,158,71,123,105,70,6,8,189,126,49,136,173,128,193,193,62,135,126,127,119,105,136,214,28,98,61,17,5,144,70,106,151,138,20,158,133,0,217,202,44,228,13,236,155,207,80,170,189,209,114,254,66,182,98,192,183,143,85,188,142,149,148,137,148,179,149,114,20,151,109,157,214,161,172,73,31,251,69,197,2,149,204,209,40,63,17,175,35,50,42,76,167,18,18,2,245,224,168,206,225,226,240,246,238,76,17,179,139,164,12,159,235,66,0,98,43,32,19,17,25,141,46,211,169,141,132,0,217,138,132,208,194,207,71,178,21,100,254,178,48,212,246,76,31,198,86,144,249,139,61,120,214,214,120,24,91,65,238,137,173,13,181,61,235,33,182,130,244,48,192,162,213,30,66,11,107,12,177,21,176,67,202,154,195,89,32,145,173,56,115,232,72,115,134,101,14,30,43,35,221,162,99,173,235,62,71,246,10,83,239,123,43,236,154,235,112,232,72,45,174,99,37,243,110,89,132,182,249,72,154,57,26,183,9,71,234,206,181,94,70,160,175,207,1,222,245,98,22,121,217,107,31,45,127,94,48,142,187,165,167,73,215,187,178,204,28,31,121,236,195,109,200,86,62,4,219,218,86,40,91,65,122,24,156,202,90,243,190,160,47,196,86,144,185,9,235,12,103,145,241,127,125,39,154,212,96,43,65,166,237,126,214,28,62,131,163,228,32,85,214,42,6,7,111,130,57,139,143,97,108,5,159,191,56,67,208,177,57,100,43,142,157,251,212,52,148,173,136,76,132,179,149,167,174,208,247,123,136,173,32,247,57,82,211,200,92,244,57,250,23,141,58,216,138,72,88,16,82,243,139,142,252,205,36,4,160,204,129,244,57,24,25,147,60,248,226,182,80,205,1,214,19,60,77,94,116,212,140,165,201,86,102,160,110,100,79,40,115,128,61,12,145,209,24,193,132,106,158,8,64,53,7,194,86,16,25,162,110,11,129,145,108,133,153,195,150,239,69,109,153,57,68,136,214,21,96,205,177,174,239,69,203,255,0,165,190,169,79,6,192,255,42,0,0,0,0,73,69,78,68,174,66,96,130]) },
        { code: 'sample_mat2x4_f32(uv, mat2x4<f32>(1, 2, 3, 4, 5, 6, 7, 8))', lines: 8, expected: Uint8Array.from([137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,0,180,0,0,0,48,8,2,0,0,0,55,142,199,171,0,0,0,1,115,82,71,66,0,174,206,28,233,0,0,2,93,73,68,65,84,120,94,237,156,81,115,131,48,12,131,225,255,255,232,238,129,94,150,75,82,248,160,190,98,20,237,169,91,211,96,203,58,215,138,96,235,226,31,35,240,1,129,117,89,150,215,235,181,189,187,174,239,95,183,23,219,91,229,143,245,154,79,120,150,245,6,92,0,129,117,99,70,67,139,173,198,13,51,122,234,52,249,215,91,9,64,227,20,222,12,104,216,80,247,140,242,186,95,211,195,231,206,161,68,169,189,246,80,119,142,250,203,165,124,233,152,28,74,84,232,115,137,156,57,154,217,69,27,184,25,178,123,15,158,51,164,234,28,207,34,64,59,71,51,133,12,47,227,206,113,22,253,228,235,145,90,41,114,23,78,27,30,75,147,87,29,134,135,212,74,115,230,177,191,181,153,1,161,207,191,12,169,21,72,14,159,115,228,175,247,169,8,233,204,113,56,79,148,5,228,32,245,84,136,94,124,23,2,86,43,119,33,255,128,235,134,117,142,222,163,121,64,246,14,113,23,1,164,86,134,254,75,179,109,61,135,122,38,213,96,29,82,43,181,171,114,88,248,195,5,26,192,205,144,5,82,43,67,123,214,157,67,158,31,158,57,228,75,124,61,65,171,149,235,216,201,127,146,118,14,226,173,192,53,242,152,202,36,136,212,10,241,86,224,26,25,224,102,72,4,169,21,114,124,78,238,19,155,1,80,165,28,145,90,129,228,168,113,217,241,111,149,224,211,206,133,206,28,135,222,10,33,144,54,148,122,217,89,173,232,213,52,44,163,246,249,148,225,125,231,196,55,177,43,27,86,147,52,27,253,127,173,212,83,194,133,231,86,124,106,158,166,166,97,129,12,58,71,63,61,16,111,165,238,28,158,70,195,234,115,235,70,99,114,244,157,3,62,183,226,177,244,214,106,6,95,60,76,173,184,115,4,87,38,193,118,86,43,9,138,144,53,4,170,86,136,111,2,207,66,178,66,225,184,90,4,144,90,33,190,137,213,138,30,185,144,90,33,99,166,103,142,89,200,49,116,209,246,123,131,239,33,213,36,71,212,127,246,241,204,33,198,15,171,21,177,130,70,166,67,213,202,97,87,176,183,18,89,150,28,123,33,181,66,158,91,169,211,177,114,201,81,220,111,163,64,106,133,120,43,37,16,51,227,219,154,164,249,124,176,183,98,102,164,169,108,64,32,97,222,10,57,66,13,136,215,91,252,16,1,171,149,31,130,253,180,75,81,181,66,26,195,161,162,121,26,56,179,199,139,212,202,89,111,197,147,135,6,173,144,90,33,222,10,185,207,84,3,178,121,178,64,106,133,144,195,222,138,30,105,130,213,202,6,144,239,33,213,32,202,31,41,196,181,79,183,207,115,49,0,0,0,0,73,69,78,68,174,66,96,130]) },
      ];

      for (const test of tests) {
        const pre = document.createElement('pre');
        pre.innerText = test.code;
        document.body.appendChild(pre);

        const canvas = document.createElement('canvas');
        const width = 30;
        canvas.height = 1 * 6 * test.lines;
        canvas.width = 1 * 6 * width;
        document.body.appendChild(canvas);

        const context = canvas.getContext('webgpu');
        if (!context) document.body.textContent = 'Unable to get webgpu canvas context';

        context.configure({ device, format });

        const wgsl = String.raw;
        const pipeline = await device.createRenderPipelineAsync({
          layout: 'auto',
          vertex: {
            module: device.createShaderModule({
              code: wgsl`
                struct Output {
                  @builtin(position) position: vec4<f32>,
                  @location(0) uv: vec2<f32>,
                }

                @vertex
                fn main(@builtin(vertex_index) i: u32) -> Output {
                  let uv = array(vec2f(0,  1), vec2f(4, 1), vec2f(0, 0), vec2f(4, 0));
                  return Output(vec4f(uv[i] * 2 - 1, 0, 1), uv[i]);
                }`,
            }),
          },
          fragment: {
            targets: [{ format }],
            module: device.createShaderModule({
              code: wgsl`
                ${await (await fetch('visual_debugger.wgsl')).text()}

                // required to generate NAN or INF
                fn u32tof32(in: u32) -> f32 {
                  return bitcast<f32>(in);
                }

                @fragment
                fn main(
                  @location(0) unscaledUv: vec2<f32>
                ) -> @location(0) vec4<f32> {
                  let uv = unscaledUv * vec2f(${width}, ${test.lines});
                  return vec4<f32>(${test.code});
                }
              `,
            }),
          },
          primitive: { topology: 'triangle-strip' },
        });

        const commandEncoder = device.createCommandEncoder();
        const pass = commandEncoder.beginRenderPass({
          colorAttachments: [{ view: context.getCurrentTexture().createView(), loadOp: 'clear', storeOp: 'store' }],
        });
        pass.setPipeline(pipeline);
        pass.draw(4, 1);
        pass.end();
        device.queue.submit([commandEncoder.finish()]);

        canvas.toBlob(async blob => {
          const buffer = await blob.arrayBuffer();
          const bytes = new Uint8Array(buffer);

          const equal = (() => {
            if (!test.expected) {
              return false;
            }

            if (bytes.length !== test.expected.length) {
              return false;
            }

            for (let i = 0; i < test.expected.length; i++) {
              if (bytes[i] !== test.expected[i]) {
                return false;
              }
            }

            return true;
          })();

          if (!equal) {
            console.error(`Test case failed: ${test.code}`);
            console.debug(
              `        { code: '${test.code}', lines: ${test.lines}, expected: Uint8Array.from([${bytes}]) },`,
            );
          }

          pre.innerText += equal ? '✅' : '❌';
        });
      }
    </script>
    <style>
      body {
        background: #000;
        color: #fff;
        display: flex;
        flex-wrap: wrap;
        align-items: baseline;
      }
      pre {
        margin: 0px;
        text-align: right;
        flex-basis: 50%;
      }
    </style>
  </body>
</html>
